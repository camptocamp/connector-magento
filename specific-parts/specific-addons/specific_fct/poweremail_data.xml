<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data noupdate="1">

        <record id="poweremail.ir_cron_mail_scheduler_action" model="ir.cron">
            <field name="active" eval="True"/>
            <field name="numbercall">-1</field>
        </record>

        <record id="partner_channel_shop" model="res.partner.canal">
            <field name="name">Magento Order</field>
        </record>

        <record id="partner_event_type_invoice" model="res.partner.event.type">
            <field name="name">EMAIL: Envoi de mail avec facture au client</field>
            <field name="key">email_invoice_after_delivery</field>
        </record>

        <record id="debonix_account_for_invoices" model="poweremail.core_accounts">
            <field name="name">Debonix</field>
            <field name="user" model="res.users" search="[('login', '=', 'admin')]"/>
            <field name="email_id">contact@debonix.fr</field>
            <field name="smtpserver">smtp.googlemail.com</field>
            <field name="smtpport">587</field>
            <field name="smtpuname">contact@debonix.fr</field>
            <field name="smtppass">Debonix74</field>
            <field name="smtptls" eval="True"/>
            <field name="smtpssl" eval="False"/>
            <field name="send_pref">html</field>
            <field name="company">yes</field>
            <field name="rec_headers_den_mail" eval="False"/>
        </record>

        <record id="debonix_server_action_for_invoices" model="ir.actions.server">
            <field name="name">Send an email with invoice after delivery</field>
            <field name="state">poweremail</field>
            <field name="condition">(object.address_invoice_id.email or object.partner_id.emailid) and object.type == 'out_invoice'</field>
            <field name="model_id" model="ir.model" search="[('model', '=', 'account.invoice')]"/>
        </record>

        <record id="debonix_template_for_invoices" model="poweremail.templates">
            <field name="name">Envoi de mail avec facture au client</field>
            <field name="object_name" model="ir.model" search="[('model', '=', 'account.invoice')]"/>
            <field name="model_int_name">account.invoice</field>
            <field name="def_to">${object.address_invoice_id.email or object.partner_id.emailid}</field>
            <field name="lang">${object.partner_id.lang or 'fr_FR'}</field>
            <field name="def_subject">Your invoice (reference: ${object.name})</field>
            <field name="def_body_text">Dear ${object.partner_id.name},
Thank you for purchasing.
Please find enclosed your invoice with reference ${object.name}.

Best Regards,
Debonix</field>
            <field name="file_name">invoice_${object.name}</field>
            <field name="report_template" search="[('report_name', '=', 'account.invoice_c2c')]"/>
            <field name="enforce_from_account" ref="debonix_account_for_invoices"/>
            <field name="auto_email">1</field>
            <field name="attached_wkf" ref="account.wkf"/>
            <field name="attached_activity" ref="account.act_open"/>
            <field name="server_action" ref="debonix_server_action_for_invoices"/>
            <field name="partner_event">${object.partner_id.id}</field>
            <field name="partner_event_type_id" ref="partner_event_type_invoice"/>
            <field name="canal_id" ref="partner_channel_shop"/>
            <field name="partner_type">customer</field>
            <field name="template_language">mako</field>
        </record>

        <record id="debonix_server_action_for_invoices" model="ir.actions.server">
            <field name="poweremail_template" ref="debonix_template_for_invoices"/>
        </record>

    </data>
</openerp>
